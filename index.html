<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Emotion Detection AI</title>

  <!-- MediaPipe -->
  <script src="https://cdn.jsdelivr.net/npm/@mediapipe/face_detection/face_detection.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@mediapipe/camera_utils/camera_utils.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@mediapipe/drawing_utils/drawing_utils.js"></script>

  <style>
    body {
      background: #111;
      color: white;
      text-align: center;
      font-family: Arial;
    }
    video, canvas {
      position: absolute;
      left: 50%;
      transform: translateX(-50%);
    }
    button {
      margin-top: 20px;
      padding: 14px 26px;
      font-size: 16px;
      background: #00ffcc;
      border: none;
      border-radius: 8px;
      cursor: pointer;
    }
  </style>
</head>

<body>

<h1>Facial Emotion Detection AI</h1>
<p>iPad-compatible browser AI</p>

<button id="startBtn">Start Camera</button>

<br><br>

<video id="video" width="320" height="240" playsinline></video>
<canvas id="canvas" width="320" height="240"></canvas>

<script>
  const videoElement = document.getElementById("video");
  const canvasElement = document.getElementById("canvas");
  const canvasCtx = canvasElement.getContext("2d");
  const startBtn = document.getElementById("startBtn");

  const faceDetection = new FaceDetection({
    locateFile: (file) =>
      `https://cdn.jsdelivr.net/npm/@mediapipe/face_detection/${file}`,
  });

  faceDetection.setOptions({
    model: "short",
    minDetectionConfidence: 0.6,
  });

  faceDetection.onResults((results) => {
    canvasCtx.clearRect(0, 0, canvasElement.width, canvasElement.height);
    canvasCtx.drawImage(
      results.image,
      0,
      0,
      canvasElement.width,
      canvasElement.height
    );

    if (results.detections.length > 0) {
      drawDetections(canvasCtx, results.detections);
    }
  });

  startBtn.onclick = async () => {
    const camera = new Camera(videoElement, {
      onFrame: async () => {
        await faceDetection.send({ image: videoElement });
      },
      width: 320,
      height: 240,
    });
    camera.start();
  };
</script>

</body>
</html>
